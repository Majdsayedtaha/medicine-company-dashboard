<!-- Button trigger modal-->
<div class="d-flex justify-content-end">
  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    <fa-icon [icon]="faUser"></fa-icon>
    Add User
  </button>

  <button
    type="button"
    class="btn btn-success excel-btn"
    data-toggle="tooltip"
    data-placement="top"
    title="Import Excel Template"
    (click)="importTemplateToEXCEL()">
    <fa-icon [icon]="faDownload"></fa-icon> Download
  </button>
  <button
    type="button"
    class="btn btn-info excel-btn"
    data-toggle="tooltip"
    data-placement="top"
    title="Export Excel Template">
    <label for="input_file">
      <fa-icon [icon]="faUpload"></fa-icon> Upload
      <input class="pointer" id="input_file" type="file" (change)="importingExcel($event)" />
    </label>
  </button>
</div>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">User Info</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form #userForm="ngForm">
          <!-- First Name -->
          <label for="inputFirstName" class="col-sm-1 col-form-label">FirstName</label>
          <input
            type="text"
            class="form-control"
            id="inputFirstName"
            placeholder="FirstName"
            name="firstName"
            #firstName="ngModel"
            [(ngModel)]="user.firstName"
            required
            maxlength="15" />
          <!-- ERROR Massage First Name-->
          <p *ngIf="firstName.invalid && firstName.touched" class="text-danger">
            you must enter
            <span *ngIf="firstName.errors?.['required']"> FirstName is required</span>
            <span *ngIf="firstName.errors?.['maxlength']">
              maximum must be
              {{firstName.errors?.['maxlength']?.['requiredLength'] }} letters At Least!
            </span>
          </p>

          <!-- Last Name -->
          <label for="inputLastName" class="col-sm-1 col-form-label">LastName</label>
          <input
            type="text"
            class="form-control"
            id="inputLastName"
            placeholder="lastName"
            name="lastName"
            #lastName="ngModel"
            [(ngModel)]="user.lastName"
            required
            maxlength="15" />
          <!-- ERROR Massage Last Name -->
          <p *ngIf="lastName.invalid && lastName.touched" class="text-danger">
            you must enter
            <span *ngIf="lastName.errors?.['required']"> LastName is required</span>
            <span *ngIf="lastName.errors?.['maxlength']">
              maximum must be
              {{lastName.errors?.['maxlength']?.['requiredLength'] }} letters At Least!
            </span>
          </p>

          <!-- Email -->
          <label for="inputemail" class="col-sm-1 col-form-label">Email</label>
          <input
            type="email"
            class="form-control"
            id="inputEmail"
            placeholder="Email"
            name="email"
            [(ngModel)]="user.email"
            #email="ngModel"
            email
            required
            pattern="[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{1,63}$" />
          <!-- ERROR Massage Email-->
          <p *ngIf="email.invalid && email.touched" class="text-danger">you must enter the email</p>

          <!-- Password -->
          <label for="inputemail" class="col-sm-1 col-form-label">Password</label>
          <input
            type="password"
            class="form-control"
            id="inputPassword"
            placeholder="Password"
            name="password"
            [(ngModel)]="user.password"
            #password="ngModel"
            required
            minlength="8"
            maxlength="20" />
          <!-- ERROR Massage Password-->
          <p *ngIf="password.invalid && password.touched" class="text-danger">you must enter the password</p>
          <span class="text-danger" *ngIf="password.errors?.['minlength'] &&password.touched">
            minimum must be 8 Numbers
          </span>

          <!-- Role -->
          <label for="inputRole" class="form-label">Role</label>
          <select id="inputRole" class="form-select" required name="role" [(ngModel)]="user.role" #role="ngModel">
            <option selected>Choose...</option>
            <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
          </select>
          <!-- ERROR Massage Role-->
          <p class="text-danger" *ngIf="!role.valid && role.touched">You must select role</p>

          <!--Region & City & Country  -->
          <div class="d-flex mt-2">
            <!-- Region -->
            <label for="inputRegion" class="form-label">Region</label>
            <select
              id="inputRegion"
              class="form-select"
              required
              name="region"
              [(ngModel)]="user.region"
              #region="ngModel">
              <option selected>Choose...</option>
              <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
            </select>

            <!-- City -->
            <label for="inputCity" class="form-label ms-2">City</label>
            <select id="inputCity" class="form-select" required name="city" [(ngModel)]="user.city" #city="ngModel">
              <option selected>Choose...</option>
              <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
            </select>

            <!-- Country -->
            <label for="inputCountry" class="form-label ms-2">Country</label>
            <select
              id="inputCountry"
              class="form-select"
              required
              name="country"
              [(ngModel)]="user.country"
              #country="ngModel">
              <option selected>Choose...</option>
              <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
            </select>
          </div>
          <div>
            <!-- ERROR Massage Region-->
            <p class="text-danger" *ngIf="!region.valid && region.touched">You must select region</p>
            <!-- ERROR Massage City-->
            <p class="text-danger" *ngIf="!city.valid && city.touched">You must select city</p>
            <!-- ERROR Massage Country-->
            <p class="text-danger" *ngIf="!country.valid && country.touched">You must select country</p>
          </div>
          <!-- Special Mark-->
          <label for="inputSpecialMark" class="col-sm-1 col-form-label">SpecialMark</label>
          <input
            type="text"
            class="form-control"
            id="inputSpecialMark"
            placeholder="SpecialMark"
            name="specialMark"
            #specialMark="ngModel"
            [(ngModel)]="user.specialMark"
            required
            maxlength="15" />
          <!-- ERROR Massage Special Mark-->
          <p *ngIf="specialMark.invalid && specialMark.touched" class="text-danger">
            you must enter
            <span *ngIf="specialMark.errors?.['required']"> SpecialMark is required</span>
            <span *ngIf="specialMark.errors?.['maxlength']">
              maximum must be
              {{specialMark.errors?.['maxlength']?.['requiredLength'] }} letters At Least!
            </span>
          </p>
        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary" data-bs-dismiss="modal" (click)="onSubmit(userForm)">
          Save user
        </button>
      </div>
    </div>
  </div>
</div>

<!-- <table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">FirstName</th>
      <th scope="col">LastName</th>
      <th scope="col">Email</th>
      <th scope="col">Role</th>
      <th scope="col">Region</th>
      <th scope="col">Country</th>
      <th scope="col">City</th>
      <th scope="col">SpecialMark</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let user of users; let i = index">
      <th scope="row">{{ i + 1 }}</th>
      <td>{{ user.firstName }}</td>
      <td>{{ user.lastName }}</td>
      <td>{{ user.email }}</td>
      <td>{{ roles[user.role ? user.role : 5] }}</td>
      <td>{{ user.region }}</td>
      <td>{{ user.country }}</td>
      <td>{{ user.city }}</td>
      <td>{{ user.specialMark }}</td>
    </tr>
  </tbody>
</table> -->

<button (click)="getSelectedRows()">Get Selected Rows</button>
<button (click)="deleteRowUser()">dalete Selected Rows</button>
<button (click)="updateUser()">dalete Selected Rows</button>
<ag-grid-angular
  #agGrid
  style="width: 900px; height: 800px"
  class="ag-theme-alpine"
  (gridReady)="gridReady($event)"
  [gridOptions]="gridOptin"
  [columnDefs]="columnDefs"
  rowSelection="multiple"></ag-grid-angular>
